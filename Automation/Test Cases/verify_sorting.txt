*** Settings ***
Resource  ../Common/tabular_resources.txt
#Force Tags  TC-007
Suite Setup  Open Browser And Redirect To Url
Suite Teardown  Close Browser Window
Test Teardown  Run Keyword If Test Failed  Log Browser State
# Author: Hardik.gosai

*** Test Cases ***
Verify Sorting On Name
    Sorting Columns Of Table  1  desc

Verify Sorting On Task Progress
    Sorting Columns Of Table  2  desc

Verify Sorting On Gender
    Sorting Columns Of Table  3  asc

Verify Sorting On Color
    Sorting Columns Of Table  5  asc

Verify Sorting On Date Of Birth
    Sorting Columns Of Table  6  desc


*** Keywords ***
Sorting Columns Of Table  [Arguments]  ${ColumnNumber}  ${SortingMethod}
    @{SortingMethodList} =   Create List  asc  desc
    Should Contain  ${SortingMethodList}  ${SortingMethod}
    ${Column} =  set variable  ${TableHeaders}\[${ColumnNumber}\]
    ${SortingAttribute} =  get element attribute  ${TableHeaders}\[${ColumnNumber}\]  aria-sort
    Run Keyword And Return IF  '${SortingAttribute}' == '${SortingMethod}'  Log  ALready sorted to ${SortingMethod}
    ${TableData} =  Get Table Data From Table Pages   ${ColumnNumber}
    Run Keyword If  ${ColumnNumber} == 6  Sort Dates In List  ${TableData}
    ...  ELSE  Sort List  ${TableData}
    Run Keyword If  '${SortingMethod}' == 'desc'  reverse list  ${TableData}
    FOR  ${index}  IN RANGE  1  4
        ${SortingAttribute} =  Get Element Attribute  ${TableHeaders}\[${ColumnNumber}\]  aria-sort
        Exit For Loop If  '${SortingAttribute}' == '${SortingMethod}'
        Click Element  ${Column}
    END
    ${SortedTableData} =  Get Table Data From Table Pages   ${ColumnNumber}
    should be equal  '${SortingAttribute}'  '${SortingMethod}'
    should be equal  ${SortedTableData}  ${TableData}
